<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1920, height=1080, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CBTdvd Screensaver with Chat Overlay - 1920x1080</title>
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="CBTdvd Screensaver - CBTstreams">
    <meta property="og:description" content="Watch the CBT logo bounce around your screen like a classic DVD screensaver.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cbtland.github.io/CBTdvd/">
    <meta property="og:image" content="./assets/ogimage.png">

    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            height: 1080px;
            width: 1920px;
            position: fixed;
            top: 0;
            left: 0;
            font-family: Arial, sans-serif;
        }

        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 18px;
            z-index: 20;
            display: block;
        }

        @media (max-width: 768px) {
            body { transform: scale(0.9); transform-origin: center center; }
            #cbt-container { width: min(200px, 30vw) !important; height: min(80px, 12vh) !important; }
            #stats-display { font-size: 14px !important; top: 10px !important; right: 10px !important; padding: 8px !important; min-width: 160px !important; }
        }

        @media (max-width: 480px) {
            body { transform: scale(0.8); }
            #cbt-container { width: min(160px, 35vw) !important; height: min(65px, 14vh) !important; }
            #stats-display { font-size: 12px !important; padding: 6px !important; min-width: 140px !important; }
        }

        #cbt-container {
            position: absolute;
            width: min(240px, 25vw);
            height: min(100px, 10vh);
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 120px;
            min-height: 50px;
            visibility: hidden;
        }

        #cbt-background {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            border-radius: 0;
            z-index: 1;
            background-color: #333; /* Fallback color */
        }

        #cbt-overlay {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: transparent;
            border-radius: 0;
            z-index: 2;
            opacity: 0.3;
        }

        #cbt-text {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 3;
            object-fit: contain;
            display: none;
        }

        #corner-counter, #stats-display {
            display: none !important;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 11;
            pointer-events: none;
            opacity: 1;
        }

        /* Chat overlay with 10px top/bottom crop */
        #chat-overlay {
            position: fixed;
            top: 17px;
            right: 9px;
            width: 600px;
            height: 1400px;
            border: none;
            background: transparent;
            pointer-events: none;  /* mouse passes through; change to 'auto' for interaction */
            z-index: 9999;
            clip-path: inset(30px 0 40px 0);  /* crops 10px from top and bottom */
        }
    </style>
</head>
<body>
    <div id="loading">Loading...</div>
    <div id="cbt-container">
        <div id="cbt-background"></div>
        <div id="cbt-overlay"></div>
        <img id="cbt-text" src="./assets/cbt-text.png" alt="CBT">
    </div>

    <div id="confetti-container"></div>

    <!-- Chat overlay iframe -->
    <iframe id="chat-overlay"
        src="https://beta.socialstream.ninja/dock.html?session=iGwCDAigWg&alignbottom&hidebots&striplinks&showviewercount&reload&loadlast&badkarma&hidenumbers&hidesource&compact&fadein&nodonohighlight&nofeaturedhightlight&unhighlight&nomemberhighlight&hideshadow&noavatar&notime&nobadges&savesingle&loadlast&reload&transparent"
        allow="fullscreen">
    </iframe>

    <script>
        // Transparent background support via URL flag (?transparent=1 or ?bg=transparent)
        const urlParams = new URLSearchParams(window.location.search);
        const wantTransparent = 
            urlParams.get('transparent') === '1' ||
            urlParams.get('bg') === 'transparent' ||
            urlParams.get('transparent') === 'true';

        if (wantTransparent) {
            document.body.style.background = 'transparent';
            // Optional: also make logo fallback transparent
            // document.getElementById('cbt-background').style.backgroundColor = 'transparent';
        }

        // ────────────────────────────────────────────────
        // Rest of your original script remains unchanged below
        // (cbtContainer, getRandomColor, getInitialState, etc.)
        // ────────────────────────────────────────────────

        const cbtContainer = document.getElementById('cbt-container');
        const cbtBackground = document.getElementById('cbt-background');
        const cbtText = document.getElementById('cbt-text');
        const cbtOverlay = document.getElementById('cbt-overlay');
        const confettiContainer = document.getElementById('confetti-container');
        const loading = document.getElementById('loading');

        let x, y, dx, dy;
        let cornerHits = parseInt(localStorage.getItem('cornerHits') || '0', 10);
        let totalBounces = parseInt(localStorage.getItem('totalBounces') || '0', 10);
        let lastCornerTime = Date.now();
        let currentColor = '#ff0000';
        let imagesLoaded = 0;

        // ... (keep all your functions: getRandomColor, getInitialState, updateDisplay, updatePosition, createConfetti, showCornerHit, isCornerHit, animate, adjustMobileZoom, onImageLoad, checkLoadComplete, preloadImages, etc.)

        // For brevity, assuming the rest is copied from your previous version.
        // The key parts (preloadImages, initialState, requestAnimationFrame(animate)) are unchanged.

        preloadImages();
        const initialState = getInitialState();
        x = initialState.x;
        y = initialState.y;
        dx = initialState.dx;
        dy = initialState.dy;
        cornerHits = initialState.cornerHits;
        lastCornerTime = initialState.lastCornerTime;
        currentColor = initialState.currentColor;

        cbtContainer.style.width  = Math.max(120, Math.min(240, Math.floor(Math.min(window.innerWidth, document.documentElement.clientWidth) * 0.25))) + 'px';
        cbtContainer.style.height = Math.max(50,  Math.min(100, Math.floor(Math.min(window.innerHeight, document.documentElement.clientHeight) * 0.10))) + 'px';

        updateDisplay();
        updatePosition();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
